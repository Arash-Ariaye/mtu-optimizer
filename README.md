
# اسکریپت بهینه‌ساز MTU

یک اسکریپت Bash برای پیدا کردن بهترین مقدار **MTU (Maximum Transmission Unit)** برای اینترفیس شبکه. این اسکریپت با تست کردن مقدارهای مختلف MTU (از **۱۴۷۵ تا ۱۴۲۰**) و مقایسه نتایج بر اساس چند معیار (**پینگ، از دست رفتن پکت‌ها و جتر**)، بهترین مقدار را پیدا کرده و به‌صورت خودکار روی اینترفیس تنظیم می‌کند.

## ✨ ویژگی‌ها
- **تست موازی:** هر بار **۵ مقدار MTU** به‌صورت همزمان تست می‌شوند تا زمان اجرا کاهش یابد.
- **تحلیل دقیق:** بهترین مقدار MTU بر اساس **کمترین از دست رفتن پکت‌ها، پینگ و جتر** انتخاب می‌شود.
- **نمایش زنده:** نتایج هر تست به‌صورت زنده در ترمینال نمایش داده می‌شود.
- **تنظیم خودکار MTU:** مقدار بهینه‌شده **به‌صورت خودکار** روی اینترفیس اعمال می‌شود.
- **قابلیت زمان‌بندی:** امکان اجرای خودکار از طریق **crontab** برای تنظیم دوره‌ای MTU.
- **ذخیره نتایج:** تمامی نتایج تست در یک فایل **mtu_test_results.txt** ذخیره می‌شوند.

## 📌 پیش‌نیازها
- **سیستم‌عامل لینوکس** (ترجیحاً Ubuntu یا Debian)
- **دسترسی به دستورات `ping` و `ip`**
- **دسترسی root** برای تنظیم MTU (اجرا با `sudo`)
- **اتصال به اینترنت** برای تست پینگ

## ⚙️ تنظیمات اولیه
قبل از اجرا، می‌توانی این تنظیمات را در اسکریپت تغییر بدهی:
- `INTERFACE`: نام اینترفیس شبکه (مثلاً `eth0` یا `wlan0`).
- `TARGET_IP`: آدرس IP برای تست پینگ (مثلاً `8.8.8.8` یا `1.1.1.1`).
- `PING_COUNT`: تعداد پکت‌ها برای هر تست (مثلاً `10`).

```bash
INTERFACE="eth0"
TARGET_IP="8.8.8.8"
PING_COUNT=10
```

---

## 🚀 نحوه استفاده
### ۱. کلون کردن مخزن
```bash
git clone https://github.com/[your-username]/mtu-optimizer.git
cd mtu-optimizer
```
### ۲. دادن دسترسی اجرا به اسکریپت
```bash
chmod +x mtu_test.sh
```
### ۳. ویرایش تنظیمات (در صورت نیاز)
با یک ویرایشگر مثل nano مقدار **INTERFACE** و **TARGET_IP** را تغییر بده:
```bash
nano mtu_test.sh
```
### ۴. اجرای اسکریپت با دسترسی root
```bash
sudo ./mtu_test.sh
```

---

## 📊 نمونه خروجی
```bash
شروع تست MTU برای IP 8.8.8.8 با ۱۰ پکت...
MTU 1475: میانگین پینگ=25.123 ms، از دست رفتن پکت‌ها=0%، جتر=1.234 ms
MTU 1474: میانگین پینگ=24.987 ms، از دست رفتن پکت‌ها=0%، جتر=0.987 ms
[...]

تست‌ها کامل شد. در حال تحلیل نتایج...

✅ بهترین MTU: 1474  
   میانگین پینگ: 24.987 میلی‌ثانیه  
   از دست رفتن پکت‌ها: 0%  
   جتر: 0.987 میلی‌ثانیه  

🔧 در حال تنظیم MTU 1474 روی اینترفیس eth0...  
✅ MTU با موفقیت روی eth0 تنظیم شد!  
📄 نتایج کامل در `mtu_test_results.txt` ذخیره شدند.
```

---

## 🕒 اجرای خودکار با Crontab
برای اجرای خودکار هر **۵ دقیقه**، اسکریپت را به crontab اضافه کن.

### ۱. انتقال اسکریپت به `/root`
```bash
sudo mv mtu_test.sh /root/mtu_test.sh
sudo chmod +x /root/mtu_test.sh
```
### ۲. افزودن به Crontab
```bash
(crontab -l 2>/dev/null; echo "*/5 * * * * /bin/bash /root/mtu_test.sh >> /var/log/mtu_optimizer.log 2>&1") | crontab -
```
### ۳. بررسی اینکه کرون‌جاب اضافه شده
```bash
crontab -l
```
🔹 باید خط زیر را ببینی:
```
*/5 * * * * /bin/bash /root/mtu_test.sh >> /var/log/mtu_optimizer.log 2>&1
```
### ۴. مشاهده لاگ‌ها
```bash
sudo cat /var/log/mtu_optimizer.log
```

---

## ⏳ تغییر زمان‌بندی (اختیاری)
می‌توانی زمان اجرای خودکار را تغییر دهی:
- **هر ۱۰ دقیقه:**
```bash
(crontab -l 2>/dev/null; echo "*/10 * * * * /bin/bash /root/mtu_test.sh >> /var/log/mtu_optimizer.log 2>&1") | crontab -
```
- **هر ساعت:**
```bash
(crontab -l 2>/dev/null; echo "0 * * * * /bin/bash /root/mtu_test.sh >> /var/log/mtu_optimizer.log 2>&1") | crontab -
```
### ❌ حذف از Crontab
```bash
crontab -e
```
سپس خط مربوط به اجرای اسکریپت را حذف کن.

---

## 📂 فایل‌های موجود
| نام فایل | توضیحات |
|----------|----------|
| `mtu_test.sh` | اسکریپت اصلی برای تست و تنظیم MTU |
| `mtu_test_results.txt` | ذخیره نتایج تست‌های قبلی |

---

## 🔧 اشکال‌یابی
🔹 **خطای "اینترفیس وجود ندارد"** → نام اینترفیس را در اسکریپت چک کن.  
🔹 **تنظیم MTU انجام نشد** → مطمئن شو که اسکریپت را با `sudo` اجرا می‌کنی.  
🔹 **خطا در تست پینگ** → اینترنت و IP موردنظر برای تست را بررسی کن.  

📄 **مشاهده نتایج ذخیره‌شده:**  
```bash
cat mtu_test_results.txt
```

---

## 📜 مجوز
این پروژه تحت **MIT License** منتشر شده است. جزئیات بیشتر در فایل `LICENSE`.

---

## 📬 تماس با من
اگه سوال یا پیشنهادی داری، می‌تونی از طریق GitHub با من در تماس باشی:  
🔗 [GitHub Profile](https://github.com/[your-username])

---

## 🚀 انتشار در GitHub
### ۱. ایجاد مخزن جدید در GitHub (مثلاً `mtu-optimizer`)
### ۲. آپلود فایل‌ها:
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/[your-username]/mtu-optimizer.git
git push -u origin main
```
📌 **[your-username]** را با نام کاربری خودت جایگزین کن.

✅ حالا README قشنگ و حرفه‌ای روی GitHub آماده است! 🎉  
```

---

**✅ تغییرات انجام شده:**  
✔ **فونت‌بندی Markdown بهبود یافت**  
✔ **اضافه کردن ایموجی برای جذابیت بیشتر**  
✔ **اضافه کردن جدول برای نمایش فایل‌های موجود**  
✔ **دسته‌بندی بهتر بخش‌ها برای خوانایی بیشتر**  

حالا کافیه اینو کپی کنی و تو `README.md` قرار بدی. 😎
